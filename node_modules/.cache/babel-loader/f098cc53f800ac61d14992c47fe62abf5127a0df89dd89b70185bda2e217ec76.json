{"ast":null,"code":"import _regeneratorRuntime from \"E:/react-todo-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"E:/react-todo-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { unwrap as aesKw } from '../runtime/aeskw.js';\nimport * as ECDH from '../runtime/ecdhes.js';\nimport { decrypt as pbes2Kw } from '../runtime/pbes2kw.js';\nimport { decrypt as rsaEs } from '../runtime/rsaes.js';\nimport { decode as base64url } from '../runtime/base64url.js';\nimport { JOSENotSupported, JWEInvalid } from '../util/errors.js';\nimport { bitLength as cekLength } from '../lib/cek.js';\nimport { importJWK } from '../key/import.js';\nimport checkKeyType from './check_key_type.js';\nimport isObject from './is_object.js';\nimport { unwrap as aesGcmKw } from './aesgcmkw.js';\nfunction decryptKeyManagement(_x, _x2, _x3, _x4, _x5) {\n  return _decryptKeyManagement.apply(this, arguments);\n}\nfunction _decryptKeyManagement() {\n  _decryptKeyManagement = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(alg, key, encryptedKey, joseHeader, options) {\n    var epk, partyUInfo, partyVInfo, sharedSecret, p2cLimit, iv, tag;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          checkKeyType(alg, key, 'decrypt');\n          _context.t0 = alg;\n          _context.next = _context.t0 === 'dir' ? 4 : _context.t0 === 'ECDH-ES' ? 7 : _context.t0 === 'ECDH-ES+A128KW' ? 9 : _context.t0 === 'ECDH-ES+A192KW' ? 9 : _context.t0 === 'ECDH-ES+A256KW' ? 9 : _context.t0 === 'RSA1_5' ? 32 : _context.t0 === 'RSA-OAEP' ? 32 : _context.t0 === 'RSA-OAEP-256' ? 32 : _context.t0 === 'RSA-OAEP-384' ? 32 : _context.t0 === 'RSA-OAEP-512' ? 32 : _context.t0 === 'PBES2-HS256+A128KW' ? 35 : _context.t0 === 'PBES2-HS384+A192KW' ? 35 : _context.t0 === 'PBES2-HS512+A256KW' ? 35 : _context.t0 === 'A128KW' ? 45 : _context.t0 === 'A192KW' ? 45 : _context.t0 === 'A256KW' ? 45 : _context.t0 === 'A128GCMKW' ? 48 : _context.t0 === 'A192GCMKW' ? 48 : _context.t0 === 'A256GCMKW' ? 48 : 57;\n          break;\n        case 4:\n          if (!(encryptedKey !== undefined)) {\n            _context.next = 6;\n            break;\n          }\n          throw new JWEInvalid('Encountered unexpected JWE Encrypted Key');\n        case 6:\n          return _context.abrupt(\"return\", key);\n        case 7:\n          if (!(encryptedKey !== undefined)) {\n            _context.next = 9;\n            break;\n          }\n          throw new JWEInvalid('Encountered unexpected JWE Encrypted Key');\n        case 9:\n          if (isObject(joseHeader.epk)) {\n            _context.next = 11;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"epk\\\" (Ephemeral Public Key) missing or invalid\");\n        case 11:\n          if (ECDH.ecdhAllowed(key)) {\n            _context.next = 13;\n            break;\n          }\n          throw new JOSENotSupported('ECDH with the provided key is not allowed or not supported by your javascript runtime');\n        case 13:\n          _context.next = 15;\n          return importJWK(joseHeader.epk, alg);\n        case 15:\n          epk = _context.sent;\n          if (!(joseHeader.apu !== undefined)) {\n            _context.next = 20;\n            break;\n          }\n          if (!(typeof joseHeader.apu !== 'string')) {\n            _context.next = 19;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"apu\\\" (Agreement PartyUInfo) invalid\");\n        case 19:\n          partyUInfo = base64url(joseHeader.apu);\n        case 20:\n          if (!(joseHeader.apv !== undefined)) {\n            _context.next = 24;\n            break;\n          }\n          if (!(typeof joseHeader.apv !== 'string')) {\n            _context.next = 23;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"apv\\\" (Agreement PartyVInfo) invalid\");\n        case 23:\n          partyVInfo = base64url(joseHeader.apv);\n        case 24:\n          _context.next = 26;\n          return ECDH.deriveKey(epk, key, alg === 'ECDH-ES' ? joseHeader.enc : alg, alg === 'ECDH-ES' ? cekLength(joseHeader.enc) : parseInt(alg.slice(-5, -2), 10), partyUInfo, partyVInfo);\n        case 26:\n          sharedSecret = _context.sent;\n          if (!(alg === 'ECDH-ES')) {\n            _context.next = 29;\n            break;\n          }\n          return _context.abrupt(\"return\", sharedSecret);\n        case 29:\n          if (!(encryptedKey === undefined)) {\n            _context.next = 31;\n            break;\n          }\n          throw new JWEInvalid('JWE Encrypted Key missing');\n        case 31:\n          return _context.abrupt(\"return\", aesKw(alg.slice(-6), sharedSecret, encryptedKey));\n        case 32:\n          if (!(encryptedKey === undefined)) {\n            _context.next = 34;\n            break;\n          }\n          throw new JWEInvalid('JWE Encrypted Key missing');\n        case 34:\n          return _context.abrupt(\"return\", rsaEs(alg, key, encryptedKey));\n        case 35:\n          if (!(encryptedKey === undefined)) {\n            _context.next = 37;\n            break;\n          }\n          throw new JWEInvalid('JWE Encrypted Key missing');\n        case 37:\n          if (!(typeof joseHeader.p2c !== 'number')) {\n            _context.next = 39;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"p2c\\\" (PBES2 Count) missing or invalid\");\n        case 39:\n          p2cLimit = (options === null || options === void 0 ? void 0 : options.maxPBES2Count) || 10000;\n          if (!(joseHeader.p2c > p2cLimit)) {\n            _context.next = 42;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"p2c\\\" (PBES2 Count) out is of acceptable bounds\");\n        case 42:\n          if (!(typeof joseHeader.p2s !== 'string')) {\n            _context.next = 44;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"p2s\\\" (PBES2 Salt) missing or invalid\");\n        case 44:\n          return _context.abrupt(\"return\", pbes2Kw(alg, key, encryptedKey, joseHeader.p2c, base64url(joseHeader.p2s)));\n        case 45:\n          if (!(encryptedKey === undefined)) {\n            _context.next = 47;\n            break;\n          }\n          throw new JWEInvalid('JWE Encrypted Key missing');\n        case 47:\n          return _context.abrupt(\"return\", aesKw(alg, key, encryptedKey));\n        case 48:\n          if (!(encryptedKey === undefined)) {\n            _context.next = 50;\n            break;\n          }\n          throw new JWEInvalid('JWE Encrypted Key missing');\n        case 50:\n          if (!(typeof joseHeader.iv !== 'string')) {\n            _context.next = 52;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"iv\\\" (Initialization Vector) missing or invalid\");\n        case 52:\n          if (!(typeof joseHeader.tag !== 'string')) {\n            _context.next = 54;\n            break;\n          }\n          throw new JWEInvalid(\"JOSE Header \\\"tag\\\" (Authentication Tag) missing or invalid\");\n        case 54:\n          iv = base64url(joseHeader.iv);\n          tag = base64url(joseHeader.tag);\n          return _context.abrupt(\"return\", aesGcmKw(alg, key, encryptedKey, iv, tag));\n        case 57:\n          throw new JOSENotSupported('Invalid or unsupported \"alg\" (JWE Algorithm) header value');\n        case 58:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _decryptKeyManagement.apply(this, arguments);\n}\nexport default decryptKeyManagement;","map":{"version":3,"names":["unwrap","aesKw","ECDH","decrypt","pbes2Kw","rsaEs","decode","base64url","JOSENotSupported","JWEInvalid","bitLength","cekLength","importJWK","checkKeyType","isObject","aesGcmKw","decryptKeyManagement","alg","key","encryptedKey","joseHeader","options","undefined","epk","ecdhAllowed","apu","partyUInfo","apv","partyVInfo","deriveKey","enc","parseInt","slice","sharedSecret","p2c","p2cLimit","maxPBES2Count","p2s","iv","tag"],"sources":["E:/react-todo-app/node_modules/jose/dist/browser/lib/decrypt_key_management.js"],"sourcesContent":["import { unwrap as aesKw } from '../runtime/aeskw.js';\nimport * as ECDH from '../runtime/ecdhes.js';\nimport { decrypt as pbes2Kw } from '../runtime/pbes2kw.js';\nimport { decrypt as rsaEs } from '../runtime/rsaes.js';\nimport { decode as base64url } from '../runtime/base64url.js';\nimport { JOSENotSupported, JWEInvalid } from '../util/errors.js';\nimport { bitLength as cekLength } from '../lib/cek.js';\nimport { importJWK } from '../key/import.js';\nimport checkKeyType from './check_key_type.js';\nimport isObject from './is_object.js';\nimport { unwrap as aesGcmKw } from './aesgcmkw.js';\nasync function decryptKeyManagement(alg, key, encryptedKey, joseHeader, options) {\n    checkKeyType(alg, key, 'decrypt');\n    switch (alg) {\n        case 'dir': {\n            if (encryptedKey !== undefined)\n                throw new JWEInvalid('Encountered unexpected JWE Encrypted Key');\n            return key;\n        }\n        case 'ECDH-ES':\n            if (encryptedKey !== undefined)\n                throw new JWEInvalid('Encountered unexpected JWE Encrypted Key');\n        case 'ECDH-ES+A128KW':\n        case 'ECDH-ES+A192KW':\n        case 'ECDH-ES+A256KW': {\n            if (!isObject(joseHeader.epk))\n                throw new JWEInvalid(`JOSE Header \"epk\" (Ephemeral Public Key) missing or invalid`);\n            if (!ECDH.ecdhAllowed(key))\n                throw new JOSENotSupported('ECDH with the provided key is not allowed or not supported by your javascript runtime');\n            const epk = await importJWK(joseHeader.epk, alg);\n            let partyUInfo;\n            let partyVInfo;\n            if (joseHeader.apu !== undefined) {\n                if (typeof joseHeader.apu !== 'string')\n                    throw new JWEInvalid(`JOSE Header \"apu\" (Agreement PartyUInfo) invalid`);\n                partyUInfo = base64url(joseHeader.apu);\n            }\n            if (joseHeader.apv !== undefined) {\n                if (typeof joseHeader.apv !== 'string')\n                    throw new JWEInvalid(`JOSE Header \"apv\" (Agreement PartyVInfo) invalid`);\n                partyVInfo = base64url(joseHeader.apv);\n            }\n            const sharedSecret = await ECDH.deriveKey(epk, key, alg === 'ECDH-ES' ? joseHeader.enc : alg, alg === 'ECDH-ES' ? cekLength(joseHeader.enc) : parseInt(alg.slice(-5, -2), 10), partyUInfo, partyVInfo);\n            if (alg === 'ECDH-ES')\n                return sharedSecret;\n            if (encryptedKey === undefined)\n                throw new JWEInvalid('JWE Encrypted Key missing');\n            return aesKw(alg.slice(-6), sharedSecret, encryptedKey);\n        }\n        case 'RSA1_5':\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512': {\n            if (encryptedKey === undefined)\n                throw new JWEInvalid('JWE Encrypted Key missing');\n            return rsaEs(alg, key, encryptedKey);\n        }\n        case 'PBES2-HS256+A128KW':\n        case 'PBES2-HS384+A192KW':\n        case 'PBES2-HS512+A256KW': {\n            if (encryptedKey === undefined)\n                throw new JWEInvalid('JWE Encrypted Key missing');\n            if (typeof joseHeader.p2c !== 'number')\n                throw new JWEInvalid(`JOSE Header \"p2c\" (PBES2 Count) missing or invalid`);\n            const p2cLimit = (options === null || options === void 0 ? void 0 : options.maxPBES2Count) || 10000;\n            if (joseHeader.p2c > p2cLimit)\n                throw new JWEInvalid(`JOSE Header \"p2c\" (PBES2 Count) out is of acceptable bounds`);\n            if (typeof joseHeader.p2s !== 'string')\n                throw new JWEInvalid(`JOSE Header \"p2s\" (PBES2 Salt) missing or invalid`);\n            return pbes2Kw(alg, key, encryptedKey, joseHeader.p2c, base64url(joseHeader.p2s));\n        }\n        case 'A128KW':\n        case 'A192KW':\n        case 'A256KW': {\n            if (encryptedKey === undefined)\n                throw new JWEInvalid('JWE Encrypted Key missing');\n            return aesKw(alg, key, encryptedKey);\n        }\n        case 'A128GCMKW':\n        case 'A192GCMKW':\n        case 'A256GCMKW': {\n            if (encryptedKey === undefined)\n                throw new JWEInvalid('JWE Encrypted Key missing');\n            if (typeof joseHeader.iv !== 'string')\n                throw new JWEInvalid(`JOSE Header \"iv\" (Initialization Vector) missing or invalid`);\n            if (typeof joseHeader.tag !== 'string')\n                throw new JWEInvalid(`JOSE Header \"tag\" (Authentication Tag) missing or invalid`);\n            const iv = base64url(joseHeader.iv);\n            const tag = base64url(joseHeader.tag);\n            return aesGcmKw(alg, key, encryptedKey, iv, tag);\n        }\n        default: {\n            throw new JOSENotSupported('Invalid or unsupported \"alg\" (JWE Algorithm) header value');\n        }\n    }\n}\nexport default decryptKeyManagement;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}