{"ast":null,"code":"import _objectSpread from \"E:/react-todo-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regeneratorRuntime from \"E:/react-todo-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"E:/react-todo-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { OidcClient, WebStorageStateStore } from '@inrupt/oidc-client';\nexport { CordovaIFrameNavigator, CordovaPopupNavigator, InMemoryWebStorage, Log, OidcClient, SessionMonitor, User, UserManager, Version, WebStorageStateStore } from '@inrupt/oidc-client';\nimport { determineSigningAlg, PREFERRED_SIGNING_ALG, getWebidFromTokenPayload, OidcProviderError, InvalidResponseError, generateDpopKeyPair, createDpopHeader, DEFAULT_SCOPES } from '@inrupt/solid-client-authn-core';\nfunction processErrorResponse(responseBody, options) {\n  var _a, _b, _c, _d;\n  if (responseBody.error === \"invalid_redirect_uri\") {\n    throw new Error(\"Dynamic client registration failed: the provided redirect uri [\".concat((_a = options.redirectUrl) === null || _a === void 0 ? void 0 : _a.toString(), \"] is invalid - \").concat((_b = responseBody.error_description) !== null && _b !== void 0 ? _b : \"\"));\n  }\n  if (responseBody.error === \"invalid_client_metadata\") {\n    throw new Error(\"Dynamic client registration failed: the provided client metadata \".concat(JSON.stringify(options), \" is invalid - \").concat((_c = responseBody.error_description) !== null && _c !== void 0 ? _c : \"\"));\n  }\n  throw new Error(\"Dynamic client registration failed: \".concat(responseBody.error, \" - \").concat((_d = responseBody.error_description) !== null && _d !== void 0 ? _d : \"\"));\n}\nfunction validateRegistrationResponse(responseBody, options) {\n  if (responseBody.client_id === undefined) {\n    throw new Error(\"Dynamic client registration failed: no client_id has been found on \".concat(JSON.stringify(responseBody)));\n  }\n  if (options.redirectUrl && (responseBody.redirect_uris === undefined || responseBody.redirect_uris[0] !== options.redirectUrl.toString())) {\n    throw new Error(\"Dynamic client registration failed: the returned redirect URIs \".concat(JSON.stringify(responseBody.redirect_uris), \" don't match the provided \").concat(JSON.stringify([options.redirectUrl.toString()])));\n  }\n}\nfunction registerClient(_x, _x2) {\n  return _registerClient.apply(this, arguments);\n}\nfunction _registerClient() {\n  _registerClient = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(options, issuerConfig) {\n    var _a, signingAlg, config, headers, registerResponse, responseBody;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          if (issuerConfig.registrationEndpoint) {\n            _context.next = 2;\n            break;\n          }\n          throw new Error(\"Dynamic Registration could not be completed because the issuer has no registration endpoint.\");\n        case 2:\n          if (Array.isArray(issuerConfig.idTokenSigningAlgValuesSupported)) {\n            _context.next = 4;\n            break;\n          }\n          throw new Error(\"The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.\");\n        case 4:\n          signingAlg = determineSigningAlg(issuerConfig.idTokenSigningAlgValuesSupported, PREFERRED_SIGNING_ALG);\n          config = {\n            client_name: options.clientName,\n            application_type: \"web\",\n            redirect_uris: [(_a = options.redirectUrl) === null || _a === void 0 ? void 0 : _a.toString()],\n            subject_type: \"public\",\n            token_endpoint_auth_method: \"client_secret_basic\",\n            id_token_signed_response_alg: signingAlg,\n            grant_types: [\"authorization_code\", \"refresh_token\"]\n          };\n          headers = {\n            \"Content-Type\": \"application/json\"\n          };\n          _context.next = 9;\n          return fetch(issuerConfig.registrationEndpoint.toString(), {\n            method: \"POST\",\n            headers: headers,\n            body: JSON.stringify(config)\n          });\n        case 9:\n          registerResponse = _context.sent;\n          if (!registerResponse.ok) {\n            _context.next = 16;\n            break;\n          }\n          _context.next = 13;\n          return registerResponse.json();\n        case 13:\n          responseBody = _context.sent;\n          validateRegistrationResponse(responseBody, options);\n          return _context.abrupt(\"return\", {\n            clientId: responseBody.client_id,\n            clientSecret: responseBody.client_secret,\n            idTokenSignedResponseAlg: responseBody.id_token_signed_response_alg,\n            clientType: \"dynamic\"\n          });\n        case 16:\n          if (!(registerResponse.status === 400)) {\n            _context.next = 23;\n            break;\n          }\n          _context.t0 = processErrorResponse;\n          _context.next = 20;\n          return registerResponse.json();\n        case 20:\n          _context.t1 = _context.sent;\n          _context.t2 = options;\n          (0, _context.t0)(_context.t1, _context.t2);\n        case 23:\n          _context.t3 = Error;\n          _context.t4 = \"Dynamic client registration failed: the server returned \".concat(registerResponse.status, \" \").concat(registerResponse.statusText, \" - \");\n          _context.next = 27;\n          return registerResponse.text();\n        case 27:\n          _context.t5 = _context.sent;\n          _context.t6 = _context.t4.concat.call(_context.t4, _context.t5);\n          throw new _context.t3(_context.t6);\n        case 30:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _registerClient.apply(this, arguments);\n}\nfunction hasError(value) {\n  return value.error !== undefined && typeof value.error === \"string\";\n}\nfunction hasErrorDescription(value) {\n  return value.error_description !== undefined && typeof value.error_description === \"string\";\n}\nfunction hasErrorUri(value) {\n  return value.error_uri !== undefined && typeof value.error_uri === \"string\";\n}\nfunction hasAccessToken(value) {\n  return value.access_token !== undefined && typeof value.access_token === \"string\";\n}\nfunction hasIdToken(value) {\n  return value.id_token !== undefined && typeof value.id_token === \"string\";\n}\nfunction hasRefreshToken(value) {\n  return value.refresh_token !== undefined && typeof value.refresh_token === \"string\";\n}\nfunction hasTokenType(value) {\n  return value.token_type !== undefined && typeof value.token_type === \"string\";\n}\nfunction hasExpiresIn(value) {\n  return value.expires_in === undefined || typeof value.expires_in === \"number\";\n}\nfunction validatePreconditions(issuer, data) {\n  if (data.grantType && (!issuer.grantTypesSupported || !issuer.grantTypesSupported.includes(data.grantType))) {\n    throw new Error(\"The issuer [\".concat(issuer.issuer, \"] does not support the [\").concat(data.grantType, \"] grant\"));\n  }\n  if (!issuer.tokenEndpoint) {\n    throw new Error(\"This issuer [\".concat(issuer.issuer, \"] does not have a token endpoint\"));\n  }\n}\nfunction validateTokenEndpointResponse(tokenResponse, dpop) {\n  if (hasError(tokenResponse)) {\n    throw new OidcProviderError(\"Token endpoint returned error [\".concat(tokenResponse.error, \"]\").concat(hasErrorDescription(tokenResponse) ? \": \".concat(tokenResponse.error_description) : \"\").concat(hasErrorUri(tokenResponse) ? \" (see \".concat(tokenResponse.error_uri, \")\") : \"\"), tokenResponse.error, hasErrorDescription(tokenResponse) ? tokenResponse.error_description : undefined);\n  }\n  if (!hasAccessToken(tokenResponse)) {\n    throw new InvalidResponseError([\"access_token\"]);\n  }\n  if (!hasIdToken(tokenResponse)) {\n    throw new InvalidResponseError([\"id_token\"]);\n  }\n  if (!hasTokenType(tokenResponse)) {\n    throw new InvalidResponseError([\"token_type\"]);\n  }\n  if (!hasExpiresIn(tokenResponse)) {\n    throw new InvalidResponseError([\"expires_in\"]);\n  }\n  if (!dpop && tokenResponse.token_type.toLowerCase() !== \"bearer\") {\n    throw new Error(\"Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [\".concat(tokenResponse.token_type, \"].\"));\n  }\n  return tokenResponse;\n}\nfunction getTokens(_x3, _x4, _x5, _x6) {\n  return _getTokens.apply(this, arguments);\n}\nfunction _getTokens() {\n  _getTokens = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(issuer, client, data, dpop) {\n    var headers, dpopKey, requestBody, tokenRequestInit, rawTokenResponse, jsonTokenResponse, tokenResponse, webId;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          validatePreconditions(issuer, data);\n          headers = {\n            \"content-type\": \"application/x-www-form-urlencoded\"\n          };\n          if (!dpop) {\n            _context2.next = 9;\n            break;\n          }\n          _context2.next = 5;\n          return generateDpopKeyPair();\n        case 5:\n          dpopKey = _context2.sent;\n          _context2.next = 8;\n          return createDpopHeader(issuer.tokenEndpoint, \"POST\", dpopKey);\n        case 8:\n          headers.DPoP = _context2.sent;\n        case 9:\n          if (client.clientSecret) {\n            headers.Authorization = \"Basic \".concat(btoa(\"\".concat(client.clientId, \":\").concat(client.clientSecret)));\n          }\n          requestBody = {\n            grant_type: data.grantType,\n            redirect_uri: data.redirectUrl,\n            code: data.code,\n            code_verifier: data.codeVerifier,\n            client_id: client.clientId\n          };\n          tokenRequestInit = {\n            method: \"POST\",\n            headers: headers,\n            body: new URLSearchParams(requestBody).toString()\n          };\n          _context2.next = 14;\n          return fetch(issuer.tokenEndpoint, tokenRequestInit);\n        case 14:\n          _context2.next = 16;\n          return _context2.sent;\n        case 16:\n          rawTokenResponse = _context2.sent;\n          _context2.next = 19;\n          return rawTokenResponse.json();\n        case 19:\n          jsonTokenResponse = _context2.sent;\n          tokenResponse = validateTokenEndpointResponse(jsonTokenResponse, dpop);\n          _context2.next = 23;\n          return getWebidFromTokenPayload(tokenResponse.id_token, issuer.jwksUri, issuer.issuer, client.clientId);\n        case 23:\n          webId = _context2.sent;\n          return _context2.abrupt(\"return\", {\n            accessToken: tokenResponse.access_token,\n            idToken: tokenResponse.id_token,\n            refreshToken: hasRefreshToken(tokenResponse) ? tokenResponse.refresh_token : undefined,\n            webId: webId,\n            dpopKey: dpopKey,\n            expiresIn: tokenResponse.expires_in\n          });\n        case 25:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _getTokens.apply(this, arguments);\n}\nfunction getBearerToken(_x7) {\n  return _getBearerToken.apply(this, arguments);\n}\nfunction _getBearerToken() {\n  _getBearerToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(redirectUrl) {\n    var signinResponse, client, webId;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          client = new OidcClient({\n            response_mode: \"query\",\n            loadUserInfo: false\n          });\n          _context3.next = 4;\n          return client.processSigninResponse(redirectUrl);\n        case 4:\n          signinResponse = _context3.sent;\n          if (!(client.settings.metadata === undefined)) {\n            _context3.next = 7;\n            break;\n          }\n          throw new Error(\"Cannot retrieve issuer metadata from client information in storage.\");\n        case 7:\n          if (!(client.settings.metadata.jwks_uri === undefined)) {\n            _context3.next = 9;\n            break;\n          }\n          throw new Error(\"Missing some issuer metadata from client information in storage: 'jwks_uri' is undefined\");\n        case 9:\n          if (!(client.settings.metadata.issuer === undefined)) {\n            _context3.next = 11;\n            break;\n          }\n          throw new Error(\"Missing some issuer metadata from client information in storage: 'issuer' is undefined\");\n        case 11:\n          if (!(client.settings.client_id === undefined)) {\n            _context3.next = 13;\n            break;\n          }\n          throw new Error(\"Missing some client information in storage: 'client_id' is undefined\");\n        case 13:\n          _context3.next = 15;\n          return getWebidFromTokenPayload(signinResponse.id_token, client.settings.metadata.jwks_uri, client.settings.metadata.issuer, client.settings.client_id);\n        case 15:\n          webId = _context3.sent;\n          return _context3.abrupt(\"return\", {\n            accessToken: signinResponse.access_token,\n            idToken: signinResponse.id_token,\n            webId: webId,\n            refreshToken: signinResponse.refresh_token\n          });\n        case 19:\n          _context3.prev = 19;\n          _context3.t0 = _context3[\"catch\"](0);\n          throw new Error(\"Problem handling Auth Code Grant (Flow) redirect - URL [\".concat(redirectUrl, \"]: \").concat(_context3.t0));\n        case 22:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3, null, [[0, 19]]);\n  }));\n  return _getBearerToken.apply(this, arguments);\n}\nfunction getDpopToken(_x8, _x9, _x10) {\n  return _getDpopToken.apply(this, arguments);\n}\nfunction _getDpopToken() {\n  _getDpopToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(issuer, client, data) {\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          return _context4.abrupt(\"return\", getTokens(issuer, client, data, true));\n        case 1:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4);\n  }));\n  return _getDpopToken.apply(this, arguments);\n}\nvar isValidUrl = function isValidUrl(url) {\n  try {\n    new URL(url);\n    return true;\n  } catch (_a) {\n    return false;\n  }\n};\nfunction refresh(_x11, _x12, _x13, _x14) {\n  return _refresh.apply(this, arguments);\n}\nfunction _refresh() {\n  _refresh = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(refreshToken, issuer, client, dpopKey) {\n    var requestBody, dpopHeader, authHeader, rawResponse, response, validatedResponse, webId;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          if (!(client.clientId === undefined)) {\n            _context5.next = 2;\n            break;\n          }\n          throw new Error(\"No client ID available when trying to refresh the access token.\");\n        case 2:\n          requestBody = {\n            grant_type: \"refresh_token\",\n            refresh_token: refreshToken,\n            scope: DEFAULT_SCOPES\n          };\n          dpopHeader = {};\n          if (!(dpopKey !== undefined)) {\n            _context5.next = 9;\n            break;\n          }\n          _context5.next = 7;\n          return createDpopHeader(issuer.tokenEndpoint, \"POST\", dpopKey);\n        case 7:\n          _context5.t0 = _context5.sent;\n          dpopHeader = {\n            DPoP: _context5.t0\n          };\n        case 9:\n          authHeader = {};\n          if (client.clientSecret !== undefined) {\n            authHeader = {\n              Authorization: \"Basic \".concat(btoa(\"\".concat(client.clientId, \":\").concat(client.clientSecret)))\n            };\n          } else if (isValidUrl(client.clientId)) {\n            requestBody.client_id = client.clientId;\n          }\n          _context5.next = 13;\n          return fetch(issuer.tokenEndpoint, {\n            method: \"POST\",\n            body: new URLSearchParams(requestBody).toString(),\n            headers: _objectSpread(_objectSpread(_objectSpread({}, dpopHeader), authHeader), {}, {\n              \"Content-Type\": \"application/x-www-form-urlencoded\"\n            })\n          });\n        case 13:\n          rawResponse = _context5.sent;\n          _context5.prev = 14;\n          _context5.next = 17;\n          return rawResponse.json();\n        case 17:\n          response = _context5.sent;\n          _context5.next = 23;\n          break;\n        case 20:\n          _context5.prev = 20;\n          _context5.t1 = _context5[\"catch\"](14);\n          throw new Error(\"The token endpoint of issuer \".concat(issuer.issuer, \" returned a malformed response.\"));\n        case 23:\n          validatedResponse = validateTokenEndpointResponse(response, dpopKey !== undefined);\n          _context5.next = 26;\n          return getWebidFromTokenPayload(validatedResponse.id_token, issuer.jwksUri, issuer.issuer, client.clientId);\n        case 26:\n          webId = _context5.sent;\n          return _context5.abrupt(\"return\", {\n            accessToken: validatedResponse.access_token,\n            idToken: validatedResponse.id_token,\n            refreshToken: typeof validatedResponse.refresh_token === \"string\" ? validatedResponse.refresh_token : undefined,\n            webId: webId,\n            dpopKey: dpopKey,\n            expiresIn: validatedResponse.expires_in\n          });\n        case 28:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5, null, [[14, 20]]);\n  }));\n  return _refresh.apply(this, arguments);\n}\nfunction removeOidcQueryParam(redirectUrl) {\n  var cleanedUrl = new URL(redirectUrl);\n  cleanedUrl.searchParams.delete(\"code\");\n  cleanedUrl.searchParams.delete(\"state\");\n  cleanedUrl.hash = \"\";\n  return cleanedUrl.toString();\n}\nfunction clearOidcPersistentStorage() {\n  return _clearOidcPersistentStorage.apply(this, arguments);\n}\nfunction _clearOidcPersistentStorage() {\n  _clearOidcPersistentStorage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n    var client, myStorage, itemsToRemove, i, key;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          client = new OidcClient({\n            response_mode: \"query\"\n          });\n          _context6.next = 3;\n          return client.clearStaleState(new WebStorageStateStore({}));\n        case 3:\n          myStorage = window.localStorage;\n          itemsToRemove = [];\n          for (i = 0; i <= myStorage.length; i += 1) {\n            key = myStorage.key(i);\n            if (key && (key.match(/^oidc\\..+$/) || key.match(/^solidClientAuthenticationUser:.+$/))) {\n              itemsToRemove.push(key);\n            }\n          }\n          itemsToRemove.forEach(function (key) {\n            return myStorage.removeItem(key);\n          });\n        case 7:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  }));\n  return _clearOidcPersistentStorage.apply(this, arguments);\n}\nexport { clearOidcPersistentStorage, getBearerToken, getDpopToken, refresh, registerClient, removeOidcQueryParam };","map":{"version":3,"names":["OidcClient","WebStorageStateStore","CordovaIFrameNavigator","CordovaPopupNavigator","InMemoryWebStorage","Log","SessionMonitor","User","UserManager","Version","determineSigningAlg","PREFERRED_SIGNING_ALG","getWebidFromTokenPayload","OidcProviderError","InvalidResponseError","generateDpopKeyPair","createDpopHeader","DEFAULT_SCOPES","processErrorResponse","responseBody","options","_a","_b","_c","_d","error","Error","redirectUrl","toString","error_description","JSON","stringify","validateRegistrationResponse","client_id","undefined","redirect_uris","registerClient","issuerConfig","registrationEndpoint","Array","isArray","idTokenSigningAlgValuesSupported","signingAlg","config","client_name","clientName","application_type","subject_type","token_endpoint_auth_method","id_token_signed_response_alg","grant_types","headers","fetch","method","body","registerResponse","ok","json","clientId","clientSecret","client_secret","idTokenSignedResponseAlg","clientType","status","statusText","text","hasError","value","hasErrorDescription","hasErrorUri","error_uri","hasAccessToken","access_token","hasIdToken","id_token","hasRefreshToken","refresh_token","hasTokenType","token_type","hasExpiresIn","expires_in","validatePreconditions","issuer","data","grantType","grantTypesSupported","includes","tokenEndpoint","validateTokenEndpointResponse","tokenResponse","dpop","toLowerCase","getTokens","client","dpopKey","DPoP","Authorization","btoa","requestBody","grant_type","redirect_uri","code","code_verifier","codeVerifier","tokenRequestInit","URLSearchParams","rawTokenResponse","jsonTokenResponse","jwksUri","webId","accessToken","idToken","refreshToken","expiresIn","getBearerToken","response_mode","loadUserInfo","processSigninResponse","signinResponse","settings","metadata","jwks_uri","getDpopToken","isValidUrl","url","URL","refresh","scope","dpopHeader","authHeader","rawResponse","response","validatedResponse","removeOidcQueryParam","cleanedUrl","searchParams","delete","hash","clearOidcPersistentStorage","clearStaleState","myStorage","window","localStorage","itemsToRemove","i","length","key","match","push","forEach","removeItem"],"sources":["E:/react-todo-app/node_modules/@inrupt/oidc-client-ext/dist/index.es.js"],"sourcesContent":["import { OidcClient, WebStorageStateStore } from '@inrupt/oidc-client';\nexport { CordovaIFrameNavigator, CordovaPopupNavigator, InMemoryWebStorage, Log, OidcClient, SessionMonitor, User, UserManager, Version, WebStorageStateStore } from '@inrupt/oidc-client';\nimport { determineSigningAlg, PREFERRED_SIGNING_ALG, getWebidFromTokenPayload, OidcProviderError, InvalidResponseError, generateDpopKeyPair, createDpopHeader, DEFAULT_SCOPES } from '@inrupt/solid-client-authn-core';\n\nfunction processErrorResponse(responseBody, options) {\r\n    var _a, _b, _c, _d;\r\n    if (responseBody.error === \"invalid_redirect_uri\") {\r\n        throw new Error(`Dynamic client registration failed: the provided redirect uri [${(_a = options.redirectUrl) === null || _a === void 0 ? void 0 : _a.toString()}] is invalid - ${(_b = responseBody.error_description) !== null && _b !== void 0 ? _b : \"\"}`);\r\n    }\r\n    if (responseBody.error === \"invalid_client_metadata\") {\r\n        throw new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(options)} is invalid - ${(_c = responseBody.error_description) !== null && _c !== void 0 ? _c : \"\"}`);\r\n    }\r\n    throw new Error(`Dynamic client registration failed: ${responseBody.error} - ${(_d = responseBody.error_description) !== null && _d !== void 0 ? _d : \"\"}`);\r\n}\r\nfunction validateRegistrationResponse(responseBody, options) {\r\n    if (responseBody.client_id === undefined) {\r\n        throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(responseBody)}`);\r\n    }\r\n    if (options.redirectUrl &&\r\n        (responseBody.redirect_uris === undefined ||\r\n            responseBody.redirect_uris[0] !== options.redirectUrl.toString())) {\r\n        throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(responseBody.redirect_uris)} don't match the provided ${JSON.stringify([\r\n            options.redirectUrl.toString(),\r\n        ])}`);\r\n    }\r\n}\r\nasync function registerClient(options, issuerConfig) {\r\n    var _a;\r\n    if (!issuerConfig.registrationEndpoint) {\r\n        throw new Error(\"Dynamic Registration could not be completed because the issuer has no registration endpoint.\");\r\n    }\r\n    if (!Array.isArray(issuerConfig.idTokenSigningAlgValuesSupported)) {\r\n        throw new Error(\"The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.\");\r\n    }\r\n    const signingAlg = determineSigningAlg(issuerConfig.idTokenSigningAlgValuesSupported, PREFERRED_SIGNING_ALG);\r\n    const config = {\r\n        client_name: options.clientName,\r\n        application_type: \"web\",\r\n        redirect_uris: [(_a = options.redirectUrl) === null || _a === void 0 ? void 0 : _a.toString()],\r\n        subject_type: \"public\",\r\n        token_endpoint_auth_method: \"client_secret_basic\",\r\n        id_token_signed_response_alg: signingAlg,\r\n        grant_types: [\"authorization_code\", \"refresh_token\"],\r\n    };\r\n    const headers = {\r\n        \"Content-Type\": \"application/json\",\r\n    };\r\n    const registerResponse = await fetch(issuerConfig.registrationEndpoint.toString(), {\r\n        method: \"POST\",\r\n        headers,\r\n        body: JSON.stringify(config),\r\n    });\r\n    if (registerResponse.ok) {\r\n        const responseBody = await registerResponse.json();\r\n        validateRegistrationResponse(responseBody, options);\r\n        return {\r\n            clientId: responseBody.client_id,\r\n            clientSecret: responseBody.client_secret,\r\n            idTokenSignedResponseAlg: responseBody.id_token_signed_response_alg,\r\n            clientType: \"dynamic\",\r\n        };\r\n    }\r\n    if (registerResponse.status === 400) {\r\n        processErrorResponse(await registerResponse.json(), options);\r\n    }\r\n    throw new Error(`Dynamic client registration failed: the server returned ${registerResponse.status} ${registerResponse.statusText} - ${await registerResponse.text()}`);\r\n}\n\nfunction hasError(value) {\r\n    return value.error !== undefined && typeof value.error === \"string\";\r\n}\r\nfunction hasErrorDescription(value) {\r\n    return (value.error_description !== undefined &&\r\n        typeof value.error_description === \"string\");\r\n}\r\nfunction hasErrorUri(value) {\r\n    return value.error_uri !== undefined && typeof value.error_uri === \"string\";\r\n}\r\nfunction hasAccessToken(value) {\r\n    return (value.access_token !== undefined && typeof value.access_token === \"string\");\r\n}\r\nfunction hasIdToken(value) {\r\n    return value.id_token !== undefined && typeof value.id_token === \"string\";\r\n}\r\nfunction hasRefreshToken(value) {\r\n    return (value.refresh_token !== undefined && typeof value.refresh_token === \"string\");\r\n}\r\nfunction hasTokenType(value) {\r\n    return value.token_type !== undefined && typeof value.token_type === \"string\";\r\n}\r\nfunction hasExpiresIn(value) {\r\n    return value.expires_in === undefined || typeof value.expires_in === \"number\";\r\n}\r\nfunction validatePreconditions(issuer, data) {\r\n    if (data.grantType &&\r\n        (!issuer.grantTypesSupported ||\r\n            !issuer.grantTypesSupported.includes(data.grantType))) {\r\n        throw new Error(`The issuer [${issuer.issuer}] does not support the [${data.grantType}] grant`);\r\n    }\r\n    if (!issuer.tokenEndpoint) {\r\n        throw new Error(`This issuer [${issuer.issuer}] does not have a token endpoint`);\r\n    }\r\n}\r\nfunction validateTokenEndpointResponse(tokenResponse, dpop) {\r\n    if (hasError(tokenResponse)) {\r\n        throw new OidcProviderError(`Token endpoint returned error [${tokenResponse.error}]${hasErrorDescription(tokenResponse)\r\n            ? `: ${tokenResponse.error_description}`\r\n            : \"\"}${hasErrorUri(tokenResponse) ? ` (see ${tokenResponse.error_uri})` : \"\"}`, tokenResponse.error, hasErrorDescription(tokenResponse)\r\n            ? tokenResponse.error_description\r\n            : undefined);\r\n    }\r\n    if (!hasAccessToken(tokenResponse)) {\r\n        throw new InvalidResponseError([\"access_token\"]);\r\n    }\r\n    if (!hasIdToken(tokenResponse)) {\r\n        throw new InvalidResponseError([\"id_token\"]);\r\n    }\r\n    if (!hasTokenType(tokenResponse)) {\r\n        throw new InvalidResponseError([\"token_type\"]);\r\n    }\r\n    if (!hasExpiresIn(tokenResponse)) {\r\n        throw new InvalidResponseError([\"expires_in\"]);\r\n    }\r\n    if (!dpop && tokenResponse.token_type.toLowerCase() !== \"bearer\") {\r\n        throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${tokenResponse.token_type}].`);\r\n    }\r\n    return tokenResponse;\r\n}\r\nasync function getTokens(issuer, client, data, dpop) {\r\n    validatePreconditions(issuer, data);\r\n    const headers = {\r\n        \"content-type\": \"application/x-www-form-urlencoded\",\r\n    };\r\n    let dpopKey;\r\n    if (dpop) {\r\n        dpopKey = await generateDpopKeyPair();\r\n        headers.DPoP = await createDpopHeader(issuer.tokenEndpoint, \"POST\", dpopKey);\r\n    }\r\n    if (client.clientSecret) {\r\n        headers.Authorization = `Basic ${btoa(`${client.clientId}:${client.clientSecret}`)}`;\r\n    }\r\n    const requestBody = {\r\n        grant_type: data.grantType,\r\n        redirect_uri: data.redirectUrl,\r\n        code: data.code,\r\n        code_verifier: data.codeVerifier,\r\n        client_id: client.clientId,\r\n    };\r\n    const tokenRequestInit = {\r\n        method: \"POST\",\r\n        headers,\r\n        body: new URLSearchParams(requestBody).toString(),\r\n    };\r\n    const rawTokenResponse = await await fetch(issuer.tokenEndpoint, tokenRequestInit);\r\n    const jsonTokenResponse = (await rawTokenResponse.json());\r\n    const tokenResponse = validateTokenEndpointResponse(jsonTokenResponse, dpop);\r\n    const webId = await getWebidFromTokenPayload(tokenResponse.id_token, issuer.jwksUri, issuer.issuer, client.clientId);\r\n    return {\r\n        accessToken: tokenResponse.access_token,\r\n        idToken: tokenResponse.id_token,\r\n        refreshToken: hasRefreshToken(tokenResponse)\r\n            ? tokenResponse.refresh_token\r\n            : undefined,\r\n        webId,\r\n        dpopKey,\r\n        expiresIn: tokenResponse.expires_in,\r\n    };\r\n}\r\nasync function getBearerToken(redirectUrl) {\r\n    let signinResponse;\r\n    try {\r\n        const client = new OidcClient({\r\n            response_mode: \"query\",\r\n            loadUserInfo: false,\r\n        });\r\n        signinResponse = await client.processSigninResponse(redirectUrl);\r\n        if (client.settings.metadata === undefined) {\r\n            throw new Error(\"Cannot retrieve issuer metadata from client information in storage.\");\r\n        }\r\n        if (client.settings.metadata.jwks_uri === undefined) {\r\n            throw new Error(\"Missing some issuer metadata from client information in storage: 'jwks_uri' is undefined\");\r\n        }\r\n        if (client.settings.metadata.issuer === undefined) {\r\n            throw new Error(\"Missing some issuer metadata from client information in storage: 'issuer' is undefined\");\r\n        }\r\n        if (client.settings.client_id === undefined) {\r\n            throw new Error(\"Missing some client information in storage: 'client_id' is undefined\");\r\n        }\r\n        const webId = await getWebidFromTokenPayload(signinResponse.id_token, client.settings.metadata.jwks_uri, client.settings.metadata.issuer, client.settings.client_id);\r\n        return {\r\n            accessToken: signinResponse.access_token,\r\n            idToken: signinResponse.id_token,\r\n            webId,\r\n            refreshToken: signinResponse.refresh_token,\r\n        };\r\n    }\r\n    catch (err) {\r\n        throw new Error(`Problem handling Auth Code Grant (Flow) redirect - URL [${redirectUrl}]: ${err}`);\r\n    }\r\n}\r\nasync function getDpopToken(issuer, client, data) {\r\n    return getTokens(issuer, client, data, true);\r\n}\n\nconst isValidUrl = (url) => {\r\n    try {\r\n        new URL(url);\r\n        return true;\r\n    }\r\n    catch (_a) {\r\n        return false;\r\n    }\r\n};\r\nasync function refresh(refreshToken, issuer, client, dpopKey) {\r\n    if (client.clientId === undefined) {\r\n        throw new Error(\"No client ID available when trying to refresh the access token.\");\r\n    }\r\n    const requestBody = {\r\n        grant_type: \"refresh_token\",\r\n        refresh_token: refreshToken,\r\n        scope: DEFAULT_SCOPES,\r\n    };\r\n    let dpopHeader = {};\r\n    if (dpopKey !== undefined) {\r\n        dpopHeader = {\r\n            DPoP: await createDpopHeader(issuer.tokenEndpoint, \"POST\", dpopKey),\r\n        };\r\n    }\r\n    let authHeader = {};\r\n    if (client.clientSecret !== undefined) {\r\n        authHeader = {\r\n            Authorization: `Basic ${btoa(`${client.clientId}:${client.clientSecret}`)}`,\r\n        };\r\n    }\r\n    else if (isValidUrl(client.clientId)) {\r\n        requestBody.client_id = client.clientId;\r\n    }\r\n    const rawResponse = await fetch(issuer.tokenEndpoint, {\r\n        method: \"POST\",\r\n        body: new URLSearchParams(requestBody).toString(),\r\n        headers: {\r\n            ...dpopHeader,\r\n            ...authHeader,\r\n            \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n        },\r\n    });\r\n    let response;\r\n    try {\r\n        response = await rawResponse.json();\r\n    }\r\n    catch (e) {\r\n        throw new Error(`The token endpoint of issuer ${issuer.issuer} returned a malformed response.`);\r\n    }\r\n    const validatedResponse = validateTokenEndpointResponse(response, dpopKey !== undefined);\r\n    const webId = await getWebidFromTokenPayload(validatedResponse.id_token, issuer.jwksUri, issuer.issuer, client.clientId);\r\n    return {\r\n        accessToken: validatedResponse.access_token,\r\n        idToken: validatedResponse.id_token,\r\n        refreshToken: typeof validatedResponse.refresh_token === \"string\"\r\n            ? validatedResponse.refresh_token\r\n            : undefined,\r\n        webId,\r\n        dpopKey,\r\n        expiresIn: validatedResponse.expires_in,\r\n    };\r\n}\n\nfunction removeOidcQueryParam(redirectUrl) {\r\n    const cleanedUrl = new URL(redirectUrl);\r\n    cleanedUrl.searchParams.delete(\"code\");\r\n    cleanedUrl.searchParams.delete(\"state\");\r\n    cleanedUrl.hash = \"\";\r\n    return cleanedUrl.toString();\r\n}\r\nasync function clearOidcPersistentStorage() {\r\n    const client = new OidcClient({\r\n        response_mode: \"query\",\r\n    });\r\n    await client.clearStaleState(new WebStorageStateStore({}));\r\n    const myStorage = window.localStorage;\r\n    const itemsToRemove = [];\r\n    for (let i = 0; i <= myStorage.length; i += 1) {\r\n        const key = myStorage.key(i);\r\n        if (key &&\r\n            (key.match(/^oidc\\..+$/) ||\r\n                key.match(/^solidClientAuthenticationUser:.+$/))) {\r\n            itemsToRemove.push(key);\r\n        }\r\n    }\r\n    itemsToRemove.forEach((key) => myStorage.removeItem(key));\r\n}\n\nexport { clearOidcPersistentStorage, getBearerToken, getDpopToken, refresh, registerClient, removeOidcQueryParam };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}